<!DOCTYPE html>
<html class="v2" dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://www.google.com/2005/gml/b" xmlns:data="http://www.google.com/2005/gml/data" xmlns:expr="http://www.google.com/2005/gml/expr" lang="en"><head>
<link href="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/3822632116-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="blogger" name="generator">
<link href="https://blog.tensorflow.org/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="The TensorFlow Blog - Atom" href="https://blog.tensorflow.org/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="The TensorFlow Blog - RSS" href="https://blog.tensorflow.org/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="The TensorFlow Blog - Atom" href="https://www.blogger.com/feeds/7864883956188652345/posts/default">

<link rel="alternate" type="application/atom+xml" title="The TensorFlow Blog - Atom" href="https://blog.tensorflow.org/feeds/8792713771000730408/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/403901366-ieretrofit.js"></script>
<![endif]-->
<link href="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/model_comparison_v4.png" rel="image_src">
<meta content="https://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html" property="og:url">
<meta content=" TensorFlow Lattice: Flexible, controlled and interpretable ML" property="og:title">
<meta content="The TensorFlow blog contains regular news from the TensorFlow team and the community, with articles on Python, TensorFlow.js, TF Lite, TFX, and more." property="og:description">
<meta content="https://1.bp.blogspot.com/-JIhDwG5oWI8/XkGvU5u4V8I/AAAAAAAACrI/xjrCMW3-F8UNfERlQITg9XmkBahPsbhPACLcBGAsYHQ/w1200-h630-p-k-no-nu/model_comparison_v4.png" property="og:image">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<meta charset="UTF-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="https://storage.googleapis.com/tensorflow-blog/image_blank.png" property="og:image">
<meta content="https://storage.googleapis.com/tensorflow-blog/image_blank.png" property="twitter:image">
<meta content="summary_large_image" name="twitter:card">
<meta content=" TensorFlow Lattice: Flexible, controlled and interpretable ML" property="twitter:title">
<title> TensorFlow Lattice: Flexible, controlled and interpretable ML — The TensorFlow Blog</title>
<meta content="" property="description">
<meta content="" property="og:description">
<style id="page-skin-1" type="text/css"><!--
/* ADD YOUR CSS HERE */
body{font-family:Roboto,sans-serif;font-size:16px;line-height:30px;-webkit-font-smoothing:antialiased;color:#000}h1{font-family:Google Sans,sans-serif;font-size:34px;font-weight:500;line-height:44px}h2{font-size:30px;line-height:40px}h2,h3{font-family:Google Sans,sans-serif;font-weight:700}h3{font-size:24px;line-height:32px}h4{font-size:20px;font-weight:500}h4,h5{font-family:Google Sans,sans-serif;line-height:26px}h5{font-size:16px;font-weight:700}h6{font-size:14px;line-height:22px}.display,h6{font-family:Google Sans,sans-serif;font-weight:700}.display{font-size:46px;line-height:56px}.hidden-text{height:1px;overflow:hidden;pointer-events:none;position:absolute;top:-10px;width:1px}img,video{border:0;height:auto;max-width:100%}body{position:relative;min-height:100vh}body.no-scroll{overflow:hidden}.content-wrap{padding-top:97px;padding-bottom:552px}@media only screen and (max-width:839px){.content-wrap{padding-top:48px}}.widget{margin:0;line-height:unset}.widget li{padding-left:12px}.widget ol,.widget ul{padding-left:40px}.widget li,.widget ol,.widget ul{line-height:unset}.tensorsite-full-footer{position:absolute;bottom:0;height:461px;width:100%}.posts-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative}.posts-container .tensorsite-posts__regular{-webkit-box-flex:3;-webkit-flex:3;-ms-flex:3;flex:3}.divider{width:100%;background-color:#e3e5e8;height:1px;margin-bottom:24px;z-index:1}.divider--lg-gap{margin:45px auto 25px}.divider--article-bottom{margin:30px 0}.divider--article-top{margin-bottom:36px}@media only screen and (max-width:767px){.divider--article-top{margin-bottom:24px}}.tensorsite-blog-logo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.tensorsite-blog-logo__image{width:auto;height:32px}.tensorsite-logo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.tensorsite-logo__image{width:auto;height:32px}@media only screen and (max-width:767px){.tensorsite-logo{margin-bottom:36px}}.wrapper{overflow:hidden}.tensorsite-container{margin:48px auto;padding:0 40px;position:relative;width:auto;max-width:1420px}@media only screen and (max-width:767px){.tensorsite-container{margin:24px auto;padding:0 20px}}@media only screen and (min-width:768px){.tensorsite-container.featured{margin:48px auto -12px}}.tensorsite-container--large{margin:48px auto;padding:0 40px;position:relative;width:auto;max-width:1050px}@media only screen and (max-width:767px){.tensorsite-container--large{margin:24px auto;padding:0 20px}}.tensorsite-container--medium{margin:48px auto;padding:0 40px;position:relative;width:auto;max-width:844px}@media only screen and (max-width:767px){.tensorsite-container--medium{margin:24px auto;padding:0 20px}}.tensorsite-container--narrow{margin:48px auto;padding:0 40px;position:relative;width:auto;max-width:682px}@media only screen and (max-width:767px){.tensorsite-container--narrow{margin:24px auto;padding:0 20px}}.tensorsite-container--flex-horizontal{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.section,body{margin:0}.tensorsite-content{border-radius:10px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:26px 30px;position:relative}.tensorsite-content .spacer{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.tensorsite-content a:not(.tensorsite-content__button),.tensorsite-content div{-webkit-transition:color .2s linear;transition:color .2s linear}.tensorsite-content ul{list-style:none;padding:0}.tensorsite-content ul li{line-height:1;margin:8px 0}.tensorsite-content ul li:last-of-type{margin-bottom:0}.tensorsite-content p{margin:0}.tensorsite-content__image-wrapper{position:relative}.tensorsite-content__image{border-radius:10px 10px 0 0;display:block;height:100%;-o-object-fit:cover;object-fit:cover;position:absolute;width:100%;-webkit-transform:scale(1.015);transform:scale(1.015);-webkit-transition:-webkit-transform .5s ease;transition:-webkit-transform .5s ease;transition:transform .5s ease;transition:transform .5s ease,-webkit-transform .5s ease;will-change:transform}@media only screen and (max-width:850px){.tensorsite-content__image{position:relative}}.tensorsite-content__subtitle{font-family:Google Sans,sans-serif;font-size:16px;font-weight:700;line-height:26px;font-weight:500!important;color:#425066;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:18px;position:relative}.tensorsite-content__subtitle b{margin:0 5px}.tensorsite-content__title{font-family:Google Sans,sans-serif;font-size:34px;font-weight:500;line-height:44px;font-weight:700!important;color:#425066;margin-bottom:12px}.tensorsite-content__title:last-child{margin-bottom:0}.tensorsite-content__title--grow{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1}.tensorsite-content__info{font-size:14px;line-height:22px;color:#616161;margin-bottom:18px}.tensorsite-content__description{font-family:Roboto,sans-serif;font-size:16px;line-height:30px;color:#616161;margin-bottom:24px}a{color:#425066;-webkit-transition:color .2s linear;transition:color .2s linear}a,a:active,a:focus{text-decoration:none}a.disabled{pointer-events:none;cursor:default;color:#ccc}a.disabled .cta-icon path{fill:#ccc}a .cta-icon{-webkit-transition:margin-right .2s linear,margin-left .2s linear;transition:margin-right .2s linear,margin-left .2s linear}a .cta-icon path{fill:#425066;-webkit-transition:fill .2s linear;transition:fill .2s linear}a .cta-icon.grey path{fill:#ccc}a .cta-icon--left{-webkit-transform:rotate(180deg);transform:rotate(180deg)}a:hover{color:#ff6f00}a:hover .cta-icon path{fill:#ff6f00}.tensorsite-card{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-backface-visibility:hidden;backface-visibility:hidden;background:#fff;border-radius:10px;-webkit-box-shadow:0 0 36px rgba(0,0,0,.1);box-shadow:0 0 36px rgba(0,0,0,.1);-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:24px 0;overflow:hidden;position:relative;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-transition:opacity .2s linear,-webkit-box-shadow .2s linear;transition:opacity .2s linear,-webkit-box-shadow .2s linear;transition:box-shadow .2s linear,opacity .2s linear;transition:box-shadow .2s linear,opacity .2s linear,-webkit-box-shadow .2s linear}.tensorsite-card.hidden{display:none}.tensorsite-card .divider{margin-bottom:18px}@media only screen and (max-width:850px){.tensorsite-card .divider{margin-bottom:14px}}.tensorsite-card.featured{min-height:300px}.tensorsite-card.featured .tensorsite-content{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.tensorsite-card.featured .tensorsite-content .tensorsite-content__title{font-size:40px;line-height:54px}@media only screen and (max-width:850px){.tensorsite-card.featured .tensorsite-content .tensorsite-content__title{font-size:26px;line-height:36px}}.tensorsite-card.featured .tensorsite-content .tensorsite-content__subtitle{margin-bottom:18px}@media only screen and (max-width:850px){.tensorsite-card.featured .tensorsite-content .tensorsite-content__subtitle{margin-bottom:10px}}@media only screen and (max-width:850px){.tensorsite-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;max-height:unset;max-width:600px;margin:24px auto}}.tensorsite-card:hover .tensorsite-content__title{color:#ff6f00}.tensorsite-card .tensorsite-content{padding:28px 30px 32px}.tensorsite-card .tensorsite-content .tensorsite-content__cta-wrapper,.tensorsite-card .tensorsite-content .tensorsite-content__description,.tensorsite-card .tensorsite-content .tensorsite-content__info,.tensorsite-card .tensorsite-content .tensorsite-content__subtitle,.tensorsite-card .tensorsite-content .tensorsite-content__title{position:relative}.tensorsite-card .tensorsite-content .tensorsite-content__subtitle{margin-bottom:14px}@media only screen and (max-width:1279px){.tensorsite-card .tensorsite-content .tensorsite-content__subtitle{margin-bottom:8px;line-height:24px;font-size:14px}}.tensorsite-card .tensorsite-content .tensorsite-content__title{margin-bottom:16px;font-size:30px}@media only screen and (max-width:1279px){.tensorsite-card .tensorsite-content .tensorsite-content__title{font-size:24px;margin-bottom:14px;line-height:32px}}.tensorsite-card .tensorsite-content .tensorsite-content__description{margin-bottom:0;display:-webkit-box;line-clamp:4;-webkit-line-clamp:4;text-overflow:ellipsis;-webkit-box-orient:vertical;overflow:hidden}.tensorsite-card .tensorsite-content .tensorsite-content__description *{color:#616161!important;font-weight:400!important}.tensorsite-card .tensorsite-content .tensorsite-content__info{font-family:Google Sans,sans-serif;margin-bottom:20px}@media only screen and (max-width:1279px){.tensorsite-card .tensorsite-content .tensorsite-content__info{line-height:24px}}@media only screen and (max-width:850px){.tensorsite-card .tensorsite-content{padding:16px 18px 20px}}.tensorsite-card .tensorsite-content__image-wrapper{background-color:#fbfcfc;overflow:hidden;position:relative;width:auto;-webkit-flex-basis:40%;-ms-flex-preferred-size:40%;flex-basis:40%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}@media only screen and (max-width:850px){.tensorsite-card .tensorsite-content__image-wrapper{max-height:250px}}.tensorsite-card .tensorsite-content__image-wrapper.hidden{display:none}.tensorsite-card:focus,.tensorsite-card:hover{-webkit-box-shadow:0 0 64px rgba(0,0,0,.22);box-shadow:0 0 64px rgba(0,0,0,.22);cursor:pointer}.tensorsite-card__href{height:100%;left:0;opacity:0;position:absolute;top:0;width:100%;z-index:2}.tensorsite-card:first-of-type{margin-top:0}.tensorsite-card:hover .tensorsite-content__image-wrapper img,.tensorsite-card__href:focus~.tensorsite-content__image-wrapper img{-webkit-transform:scale(1.03);transform:scale(1.03);-webkit-transition:-webkit-transform 1s ease;transition:-webkit-transform 1s ease;transition:transform 1s ease;transition:transform 1s ease,-webkit-transform 1s ease}.tensorsite-detail{color:#000!important}.tensorsite-detail__title{font-family:Google Sans,sans-serif;font-size:46px;font-weight:700;line-height:56px;margin-bottom:24px}@media only screen and (max-width:767px){.tensorsite-detail__title{font-family:Google Sans,sans-serif;font-size:28px;font-weight:700;line-height:1.36;margin-bottom:16px}}.tensorsite-detail__body,.tensorsite-detail__body div,.tensorsite-detail__body div>span,.tensorsite-detail__body li>span{font-family:Roboto,sans-serif!important;font-size:16px!important;line-height:28px!important;letter-spacing:0!important}.tensorsite-detail__body b,.tensorsite-detail__body strong{font-weight:500!important}.tensorsite-detail__body h1,.tensorsite-detail__body h1>span,.tensorsite-detail__body h1>strong,.tensorsite-detail__body h2,.tensorsite-detail__body h2>span,.tensorsite-detail__body h2>strong{font-family:Google Sans,sans-serif!important;font-size:30px!important;font-weight:700!important;line-height:40px!important;margin-bottom:18px!important;margin-top:40px}@media only screen and (max-width:767px){.tensorsite-detail__body h1,.tensorsite-detail__body h1>span,.tensorsite-detail__body h1>strong,.tensorsite-detail__body h2,.tensorsite-detail__body h2>span,.tensorsite-detail__body h2>strong{font-size:24px!important;line-height:34px!important;margin-bottom:12px!important;margin-top:30px}}.tensorsite-detail__body h3,.tensorsite-detail__body h3>span,.tensorsite-detail__body h3>strong{font-family:Google Sans,sans-serif!important;font-size:26px!important;font-weight:700!important;line-height:36px!important;margin-bottom:14px!important;margin-top:40px}@media only screen and (max-width:767px){.tensorsite-detail__body h3,.tensorsite-detail__body h3>span,.tensorsite-detail__body h3>strong{font-size:22px!important;line-height:32px!important;margin-bottom:12px!important;margin-top:30px}}.tensorsite-detail__body h4,.tensorsite-detail__body h4>span,.tensorsite-detail__body h4>strong{font-family:Google Sans,sans-serif!important;font-size:20px!important;font-weight:500!important;line-height:30px!important;margin-bottom:14px!important;margin-top:40px}@media only screen and (max-width:767px){.tensorsite-detail__body h4,.tensorsite-detail__body h4>span,.tensorsite-detail__body h4>strong{margin-bottom:12px!important;margin-top:30px}}.tensorsite-detail__body ol,.tensorsite-detail__body ul{margin:24px 0}@media only screen and (max-width:767px){.tensorsite-detail__body ol,.tensorsite-detail__body ul{margin:18px 0}}.tensorsite-detail__body a{color:#425066!important;text-decoration:underline!important;font-weight:500!important}.tensorsite-detail__body a:hover{color:#ff6f00!important}.tensorsite-detail__body a[imageanchor]{display:block!important;float:none!important;margin-left:0!important;margin-right:0!important}.tensorsite-detail__body img{display:block}.tensorsite-detail__body img:not(.unset-width){width:100%;border-radius:4px;margin:24px 0}.tensorsite-detail__body img.unset-width{margin:0 auto 12px}.tensorsite-detail__body iframe{width:100%}.tensorsite-detail__body .gist{margin:24px 0}.tensorsite-detail__body .tr-caption-container{width:100%;padding:0;margin:24px 0}.tensorsite-detail__body .tr-caption-container img{margin:0 0 12px}.tensorsite-detail__body .tr-caption{font-size:12.8px!important;font-style:normal!important;font-family:unset!important;line-height:1.8!important;font-weight:400!important}.tensorsite-detail__body code,.tensorsite-detail__body pre[class*=language-]{background:#f5f6f7!important;font-family:Roboto Mono,monospace!important;border-radius:2px}.tensorsite-detail__body code{padding:5px 8px}.tensorsite-detail__body pre[class*=language-]{margin:24px auto!important;line-height:1.7!important;padding:24px}@media only screen and (max-width:767px){.tensorsite-detail__body pre[class*=language-]{padding:8px 12px}}.tensorsite-detail__body pre[class*=language-] code{padding:0}.tensorsite-detail__body pre[class*=language-] .token.operator{background:unset!important}.tensorsite-detail__body .separator[style*=center]>a:not([style*=float]){margin:0!important}.tensorsite-detail__contact{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:36px}@media only screen and (max-width:767px){.tensorsite-detail__contact{margin-bottom:24px}}.tensorsite-detail__info{font-family:Google Sans,sans-serif;font-size:16px;font-weight:700;line-height:26px;font-weight:400;color:#616161;margin-right:25px}.tensorsite-detail-footer .article-divider{padding:30px 0}.tensorsite-detail-footer .tensorsite-chip{font-family:Roboto,sans-serif;font-size:16px;line-height:30px;color:#616161;border:1px solid #ebebeb;padding:4px 10px;display:inline-block;border-radius:4px;margin-bottom:4px;-webkit-transition:color .2s linear,background-color .2s linear;transition:color .2s linear,background-color .2s linear;text-decoration:none}.tensorsite-detail-footer .tensorsite-chip:hover{background-color:hsla(213,7%,76%,.2)}.tensorsite-detail-footer .tensorsite-chip:focus{background-color:hsla(213,7%,76%,.26)}.tensorsite-detail-footer .tensorsite-chip:active{background-color:hsla(213,7%,76%,.32)}.tensorsite-next{background:#f5f6f7;padding:48px 0 60px;display:none}@media only screen and (max-width:767px){.tensorsite-next{padding:48px 0 0}}.tensorsite-next.active{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.tensorsite-next__title{font-family:Google Sans,sans-serif;font-size:46px;font-weight:700;line-height:56px;margin-bottom:36px;text-align:center}@media only screen and (max-width:767px){.tensorsite-next__title{font-family:Google Sans,sans-serif;font-size:28px;font-weight:700;line-height:1.36;margin-bottom:24px}}#pagination-container{display:none}.pagination{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.pagination .arrow-link{font-family:Google Sans,sans-serif;font-size:16px;font-weight:700;line-height:20px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;text-decoration:none}.pagination .arrow-link .cta-icon{height:12px}.pagination .arrow-link .cta-icon--left{margin-left:4px}.pagination .arrow-link .cta-icon--right{margin-right:4px}.pagination .arrow-link>span{padding:0 8px}.pagination .arrow-link:hover .cta-icon--left{margin-left:0;margin-right:4px}.pagination .arrow-link:hover .cta-icon--right{margin-left:4px;margin-right:0}.filter-page__title{font-family:Google Sans,sans-serif;font-size:46px;font-weight:700;line-height:56px;line-height:46px;margin-bottom:20px}@media only screen and (max-width:767px){.filter-page__title{font-family:Google Sans,sans-serif;font-size:30px;font-weight:700;line-height:40px}}.filter-page__subtitle{font-size:18px;line-height:30px;max-width:735px}@media only screen and (max-width:767px){.filter-page__subtitle{font-family:Roboto,sans-serif;font-size:16px;line-height:28px}}.filter-page__subtitle a{text-decoration:underline;font-weight:500}.tensorsite-button{font-family:Google Sans,sans-serif;font-size:16px;font-weight:700;line-height:20px;border-radius:8px;-webkit-box-shadow:0 0 20px transparent;box-shadow:0 0 20px transparent;display:inline-block;height:auto;outline:none;padding:13px 22px;text-transform:none;-webkit-transition:background .3s linear,color .3s linear,-webkit-box-shadow .3s linear;transition:background .3s linear,color .3s linear,-webkit-box-shadow .3s linear;transition:box-shadow .3s linear,background .3s linear,color .3s linear;transition:box-shadow .3s linear,background .3s linear,color .3s linear,-webkit-box-shadow .3s linear}.tensorsite-button:active{-webkit-box-shadow:none;box-shadow:none}.tensorsite-button--orange{background:-webkit-gradient(linear,left top,right top,from(#ff6f00),to(#ff9100));background:linear-gradient(90deg,#ff6f00,#ff9100);color:#fff;overflow:hidden;position:relative;z-index:1}.tensorsite-button--orange:after{background:#ff6f00;bottom:0;content:"";left:0;opacity:0;position:absolute;right:0;top:0;-webkit-transition:opacity .3s;transition:opacity .3s;z-index:-1}.tensorsite-button--orange:focus:after,.tensorsite-button--orange:hover:after{opacity:1}.tensorsite-button--white{background:#fff;color:#425066}.tensorsite-button--white:focus,.tensorsite-button--white:hover{background:#425066;color:#fff}.tensorsite-footer{margin-top:-92px;overflow:hidden;padding-top:92px;pointer-events:none;position:relative}.tensorsite-footer:after,.tensorsite-footer:before{bottom:0;content:"";display:block;position:absolute}.tensorsite-footer:before{background:#ff6f00;left:0;right:calc(1440px + ((100% - 1440px) / 2) + 96px);top:184px}.tensorsite-footer:after{background:#ff9100;left:calc(1440px + ((100% - 1440px) / 2) + 96px);right:0;top:0}.tensorsite-footer.grey{background-color:#f5f6f7}.tensorsite-footer__container{background-image:-webkit-gradient(linear,right top,left top,color-stop(18%,#ff9100),color-stop(86%,#ff6f00));background-image:linear-gradient(-90deg,#ff9100 18%,#ff6f00 86%);margin:0 auto;max-width:calc(100% - 192px);min-height:210px;padding:70px 0;position:relative}@media screen and (min-width:1440px){.tensorsite-footer__container{max-width:1248px}}@media only screen and (max-width:767px){.tensorsite-footer__container{background-image:-webkit-gradient(linear,right top,left top,from(#ff9100),to(#ff6f00));background-image:linear-gradient(-90deg,#ff9100,#ff6f00);padding-bottom:100px}}.tensorsite-footer__side{bottom:0;position:absolute;width:192px}.tensorsite-footer__side:before{content:"";display:block;height:92px;margin-top:-92px;width:100%}.tensorsite-footer__side--left{background:#ff6f00;left:-192px;top:92px}.tensorsite-footer__side--left:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 92'%3E%3Cpath d='M162 8L96 46 30 84a60.7 60.7 0 0 1-30 8h192V0a60.7 60.7 0 0 0-30 8z' fill='%23FF6F00'/%3E%3C/svg%3E")}.tensorsite-footer__side--right{background:#ff9100;right:-192px;top:0}.tensorsite-footer__side--right:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 92'%3E%3Cpath d='M162 8L96 46 30 84a60.7 60.7 0 0 1-30 8h192V0a60.7 60.7 0 0 0-30 8z' fill='%23FF9100'/%3E%3C/svg%3E")}.tensorsite-footer__content{pointer-events:auto}.tensorsite-footer__content .tensorsite-content{margin:0 auto;max-width:650px;padding:0}.tensorsite-footer__content .tensorsite-content__title{font-family:Google Sans,sans-serif;font-size:30px;font-weight:700;line-height:40px;color:#fff;padding:0;text-align:center;width:auto}.tensorsite-footer__content .tensorsite-content__description{font-size:18px;line-height:30px;color:#fff;text-align:center}.tensorsite-footer__content .tensorsite-content__cta-wrapper{margin-top:10px;text-align:center}.tensorsite-footer__content .tensorsite-content .tensorsite-content__title+.tensorsite-content__cta-wrapper{margin-top:40px}@media only screen and (max-width:767px){.tensorsite-footer__content{margin:0 -76px}}.tensorsite-footer__lines{background:url("https://storage.googleapis.com/tensorflow-blog/tf_lines.svg") bottom/100% auto no-repeat;bottom:0;left:50%;max-width:1720px;min-width:1320px;pointer-events:none;position:absolute;top:0;-webkit-transform:translate(-50%);transform:translate(-50%);width:90vw;z-index:2}@media only screen and (max-width:767px){.tensorsite-footer__lines{-webkit-transform:translate(-30%);transform:translate(-30%)}}@media only screen and (max-width:480px){.tensorsite-footer__lines{-webkit-transform:translate(-20%);transform:translate(-20%)}}.icon-link{border-radius:50%;height:42px;width:42px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-transition:background .2s linear;transition:background .2s linear}.icon-link:hover{background-color:hsla(213,7%,76%,.2)}.icon-link:focus{background-color:hsla(213,7%,76%,.26)}.icon-link:active{background-color:hsla(213,7%,76%,.32)}.social-icons__container-header,.social-icons__links{height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.social-icons__container-header{margin-right:14px}.social-icons__container-header .icon-link{margin-right:0;margin-left:18px}@media only screen and (max-width:1000px){.social-icons__container-header{display:none}}.social-icons__container-footer{background:#f9f9f9;padding:36px 40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.social-icons__container-footer .icon-link:not(:last-of-type){margin-right:24px}@media only screen and (max-width:767px){.social-icons__container-footer{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}}.header__overlay{height:100%;left:0;position:absolute;width:100%;background-color:rgba(0,0,0,.4);-webkit-animation:fade-in .4s cubic-bezier(.39,.575,.565,1);animation:fade-in .4s cubic-bezier(.39,.575,.565,1);opacity:0;top:0;z-index:-1}.header__overlay.show{opacity:1;z-index:800;-webkit-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out}.header{position:fixed;z-index:700;top:0;width:100%;overflow:hidden;-webkit-box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15);box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15);height:97px}@media only screen and (max-width:839px){.header{height:48px}}.header .top-row{background:#fff;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:0 24px;height:48px;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid #e6e6e6}@media only screen and (max-width:839px){.header .top-row{padding:0 16px}}.header .top-row__left,.header .top-row__right{-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:0;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;height:100%}.header .nav-row,.header .top-row__left,.header .top-row__right{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.header .nav-row{background:#f5f6f7;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%}.header .nav-items{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;height:48px;position:relative;padding:0 24px}@media only screen and (max-width:839px){.header .nav-items{display:none}}.header .nav-items tab{position:relative}.header .nav-items tab.active .header__nav-item:after,.header .nav-items tab:hover .header__nav-item:after{background:#425066}@media only screen and (max-width:839px){.header .header__cta,.header .nav-items{display:none}}.header__search-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:6px 0 6px 24px;overflow:hidden;position:relative;margin-right:36px;border-radius:4px}@media only screen and (max-width:767px){.header__search-container:not(.mobile){display:none}}.header__search-container.mobile{margin:0 0 20px}.header__search-container.mobile #searchform,.header__search-container.mobile .searchbox{width:100%}.header__search-container .searchbox{border-radius:2px}.header__search-container .searchbox input{font-family:Roboto,sans-serif;font-size:16px;line-height:30px;background:#f5f6f7;color:#425066;border:0;margin:0;height:20px;outline:0;padding:8px 8px 8px 40px;width:100%;-webkit-transition:background .2s;transition:background .2s}.header__search-container .searchbox input::-webkit-input-placeholder{color:#425066}.header__search-container .searchbox input:-ms-input-placeholder,.header__search-container .searchbox input::-ms-input-placeholder{color:#425066}.header__search-container .searchbox input::placeholder{color:#425066}.header__search-container .searchbox input:hover{background:#e8eaed}.header__search-container .material-icons{color:#425066;left:8px;position:absolute;top:6px;-webkit-transition:color .2s;transition:color .2s}.header__cta{font-family:Google Sans,sans-serif;font-size:16px;font-weight:700;line-height:20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.header__cta.mobile{padding:18px 0}.header__cta:hover .cta-icon{margin-left:0;margin-right:12px}.header__cta .cta-icon{-webkit-transition:margin-right .2s linear,margin-left .2s linear;transition:margin-right .2s linear,margin-left .2s linear;margin-left:4px;margin-right:8px;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.header__nav-item{font-family:Google Sans,sans-serif;font-size:14px;font-weight:700;line-height:22px;color:#677282;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:0 36px 0 0;height:100%;text-transform:none}.header__nav-item:hover{color:#677282}.header__nav-item.mobile{font-weight:500;padding:0}.header__nav-item.mobile:hover{color:#ff6f00}.header__nav-item:after{bottom:0;border-radius:3px 3px 0 0;content:"";display:block;height:3px;left:calc(50% - 18px);min-width:20px;position:absolute;right:0;-webkit-transform:translateX(-50%);transform:translateX(-50%);width:calc(100% - 44px)}.header__hamburger{border:0;background:none;outline:none;padding:0;margin:1px 8px 0 -4px;padding:8px;color:rgba(0,0,0,.65);cursor:pointer}@media only screen and (min-width:840px){.header__hamburger{display:none}}.header__side-menu{background-color:#fff;bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%;left:0;overflow:auto;position:fixed;top:0;-webkit-transform:translateX(-100%);transform:translateX(-100%);-webkit-transition:-webkit-transform .2s cubic-bezier(.215,.61,.355,1);transition:-webkit-transform .2s cubic-bezier(.215,.61,.355,1);transition:transform .2s cubic-bezier(.215,.61,.355,1);transition:transform .2s cubic-bezier(.215,.61,.355,1),-webkit-transform .2s cubic-bezier(.215,.61,.355,1);z-index:900}.header__side-menu.is-open{height:100%;-webkit-transform:translateX(0);transform:translateX(0);width:80%}.header__side-menu__content{height:100%;padding:18px 16px 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.header__side-menu__content .spacer{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.header__side-menu__title{font-size:18px;line-height:30px;font-weight:500;margin-bottom:12px}.header__side-menu__items{list-style:none}.header__side-menu__items li{padding:12px 0}.header__side-menu__bottom{border-top:1px solid #e6e6e6}.header__side-menu__logo-container{background:#fff;height:48px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding:0 16px;border-bottom:1px solid #e6e6e6}.tensorsite__tags{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;height:650px;margin-left:40px;padding-top:40px;position:-webkit-sticky;position:sticky;top:97px}@media only screen and (max-width:850px){.tensorsite__tags{display:none}}.tensorsite__tags h2{margin-bottom:32px}.tensorsite__tags .tensorsite-tag{font-family:Google Sans,sans-serif;font-size:20px;font-weight:500;line-height:26px;color:#425066;display:block;padding:20px 0;border-bottom:1px solid #e3e5e8;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-transition:color .2s linear;transition:color .2s linear}.tensorsite__tags .tensorsite-tag:hover{color:#ff6f00}.tensorsite__tags .tensorsite-tag:hover .cta-icon{margin-left:12px;margin-right:0}.tensorsite__tags .tensorsite-tag .cta-icon{-webkit-transition:margin-right .2s linear,margin-left .2s linear;transition:margin-right .2s linear,margin-left .2s linear;margin-left:8px;margin-right:4px}
]

--></style>
<!-- Custom TensorFlow Fonts -->
<link href="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/css.css" rel="stylesheet">
<!-- End Custom TensorFlow Fonts -->
<!-- Code Block Syntax Highlighting -->
<link href="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/prism.css" rel="stylesheet">
<script src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/prism.js" type="text/javascript"></script>
<script src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/prism-autoloader.js"></script>
<!-- End Code Block Syntax Highlighting -->
<!-- Image Zoom -->
<link href="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/zoom.css" rel="stylesheet">
<script defer="defer" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/zoom-vanilla.js" type="text/javascript"></script>
<!-- End Image Zoom-->
<link href="https://storage.googleapis.com/tensorflow-blog/favicon.png" rel="shortcut icon" type="image/png">
<script type="text/javascript">
        //<![CDATA[

        const qs = (string, el = document) => el.querySelector(string);
        const qsa = (string, el = document) => el.querySelectorAll(string);

        class App {
            constructor() {
                this.body = qs('body');
                this.detailBody = qs('.tensorsite-detail__body');

                this.overlay = qs('.header__overlay');
                this.hamburger = qs('.header__hamburger');
                this.sideMenu = qs('.header__side-menu');

                this.searchForms = qsa('.searchbox');
                this.searchInputs = qsa('.search-input');

                this.homeHref = qs('#home-href');
                this.featuredCard = qs('.tensorsite-card.featured');
                this.featuredPostHref =  this.featuredCard && this.featuredCard
                          .querySelector('.tensorsite-card__href')
                          .getAttribute('href');
                this.cards = qsa('.tensorsite-card');
                this.images = qsa('img[border]');
                this.cardDescriptions = qsa('.tensorsite-content__description');
                this.hiddenDescription = qsa('.tensorsite-detail__description');

                this._toggleMobileMenu = this._toggleMobileMenu.bind(this);
                this._closeMenu = this._closeMenu.bind(this);
                this._onResize = this._onResize.bind(this);
                this._getScreen = this._getScreen.bind(this);
                this._searchGoogle = this._searchGoogle.bind(this);
                this._handleSearchKeypress = this._handleSearchKeypress.bind(this);
                this._removeDividerAboveImage();
                this._setAllTagActive();
                this._showFeaturedPost();
                this._redirectWithMaxResults();
                this._makeImagesZoomable();
                this._removeCardLineBreaks();
                this._getNextPost().then(()=>{
                  this._removeCardLineBreaks();
                })

                this.addEventListeners();
            }

            addEventListeners() {
                window.addEventListener('resize', this._onResize);
                this.hamburger.addEventListener('click', this._toggleMobileMenu);
                this.searchForms.forEach(el => el.addEventListener('submit', this._searchGoogle));
                this.searchInputs.forEach(el => el.addEventListener('keypress', this._handleSearchKeypress));
            }

            _getNextPost() {
              return new Promise((resolve) => {
                const nextHref = qs('.tensorsite-detail__next-url');

                  if (this.detailBody && nextHref) {
                    let request = new XMLHttpRequest();
                    request.open('GET', nextHref.getAttribute('href'), true);

                    request.onload = function() {
                      if (this.status >= 200 && this.status < 400) {
                        // Success! Should be an HTML response

                        // Save html in variable so you're able to query select
                        const parser = new DOMParser();
                        const html = parser.parseFromString(this.response, "text/html");

                        const nextTitle = html.querySelector('.tensorsite-detail__title');
                        const nextDesc = html.querySelector('.tensorsite-detail__description');
                        const nextTags = html.querySelector('.tensorsite-detail__tags');
                        const nextHref = qs('.tensorsite-detail__next-url').getAttribute('href');
                        const nextImgUrl = html.querySelector('.tensorsite-detail__main-image');

                        const nextTitleEl = document.querySelector('.tensorsite-content__title.next');
                        const nextDescEl = document.querySelector('.tensorsite-content__description.next');
                        let nextTagsEl = document.querySelector('.tensorsite-content__subtitle.next');
                        const nextHrefEl = document.querySelector('.tensorsite-card__href.next');
                        const nextImgEl = document.querySelector('.tensorsite-content__image-wrapper');

                        const nextContainer = qs('.tensorsite-next');
                        const footer = qs('.tensorsite-footer');

                        if (nextTitleEl && nextTitle) {
                            nextTitleEl.innerHTML = nextTitle.innerHTML;
                        }
                        if (nextDescEl && nextDesc) {
                            nextDescEl.innerHTML = nextDesc.innerHTML;
                        }
                        if (nextTagsEl && nextTags) {
                            nextTagsEl.innerHTML = nextTags.innerHTML;
                        }
                        if (nextHref && nextHrefEl) {
                            nextHrefEl.setAttribute('href', nextHref);
                        }
                        if (nextImgEl && nextImgUrl) {
                          // If Blogger can't find a firstImageUrl, it returns a
                          // message informing us of that, so this checks
                          // if the string is a URL
                          if(!/http/.test(nextImgUrl.innerHTML)){
                            nextImgEl.classList.add('hidden');
                          } else {
                            nextImgEl.querySelector('img').src = nextImgUrl.innerHTML;
                          }
                        }

                        if (nextHref) {
                          nextContainer.classList.add('active');
                          footer.classList.add('grey');
                        }

                        resolve();
                      }
                      else {
                          // We reached our target server, but it returned an error
                          console.error('Error: Could not get the next title');
                      }
                    };

                    request.send();
                  }
                })
            }

            get isMenuOpen() {
                return this.sideMenu.classList.contains('is-open');
            }

            _handleSearchKeypress(e) {
              if (e.which == 13) {
                    this._searchGoogle();
                }
            }

            _searchGoogle(e) {
                e.preventDefault();
                const {value} = e.target.querySelector('.search-input');
                window.location.href = 'https://www.google.com/search?q=site%3A' + window.location.hostname + '%20' + value;
            }

            _toggleMobileMenu() {
                this.body.classList.toggle('no-scroll');
                this.overlay.classList.toggle('show');
                this.sideMenu.classList.toggle('is-open');

                if (this.isMenuOpen) {
                    this.overlay.addEventListener('click', this._closeMenu);
                } else {
                    this.overlay.removeEventListener('click', this._closeMenu);
                }
            }

            _closeMenu(e) {
                if (this.isMenuOpen) {
                    this._toggleMobileMenu();
                }
            }

            _onResize() {
                if (this._getScreen().width > 839 && this.isMenuOpen) {
                    this._closeMenu();
                }
            }

            _getScreen() {
              return {
                scrollY: window.scrollY,
                width: window.innerWidth,
                height: window.innerHeight,
              }
            };

            _removeDividerAboveImage() {
              if (this.detailBody
                && this.detailBody.firstElementChild
                && this.detailBody.firstElementChild.querySelector('img')) {
                    const firstDivider = qs('.divider');
                    firstDivider.style.display = 'none';
              }
            }

            _isCurrentPathAllPosts(){
              const {pathname, search} = window.location;
              return pathname === '/' || (pathname === '/search' && !/label/.test(search))
            }

            _setAllTagActive() {
              if(this._isCurrentPathAllPosts()){
                const allTag = qs('.header__nav-item.all');
                allTag.parentElement.classList.add('active');
              }
            }

            // Shows featured post only if not on the home page
            _showFeaturedPost() {
              if (window.location.pathname === '/' && this.featuredCard) {
                  // If any posts in the list have the same href, hide them.
                  // Using a boolean in order to skip the first match
                  // since that is the actual featured card.
                  let skippedFirst = false;
                  this.cards.forEach(card => {
                    const link = card
                      .querySelector('.tensorsite-card__href')
                      .getAttribute('href');

                    if (link === this.featuredPostHref) {
                      if (skippedFirst) {
                        card.classList.add('hidden');
                      }
                      skippedFirst = true;
                    }

                  })
              }
            }

            _makeImagesZoomable(){
              this.images.forEach(image => {
                image.setAttribute('data-action', 'zoom');

                if(/a/i.test(image.parentNode.tagName)){
                  image.parentNode.replaceWith(image)
                }
              })
            }

            // Adds max-results query param if URL contains a label filter but
            // doesn't contain max-results
            _redirectWithMaxResults(){
              const {search} = window.location;
              const isLabelMatch = /(tensorflow|tfx|community)/gi.test(search)

              if(isLabelMatch && !/max-results/.test(search)){
                window.location.href = window.location.href + '&max-results=20'
              }
            }

            _removeCardLineBreaks(){
              const descriptions = this.cardDescriptions || [this.hiddenDescription];
              if(descriptions){
                descriptions.forEach(node=> {
                  let stringArray = node.innerText.split(/(\r\n|\n|\r)/g);
                  for(let i = stringArray.length; i > 0; i--){
                    if(/(\r\n|\n|\r)/.test(stringArray[i]) || stringArray[i] === ''){
                      let j = i - 1;
                      while(j > 0 && (/(\r\n|\n|\r)/.test(stringArray[j]) || stringArray[j] === '')){
                        stringArray.splice(j, 1);
                        j--
                      }
                    }
                  }
                  return node.innerText = stringArray.join('')
                })
              }
            }
        }

        window.addEventListener('DOMContentLoaded', (event) => {
            new App();
        });

        //]]>
        </script>
<link href="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/authorization.css" media="all" onload="if(media!='all')media='all'" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7864883956188652345&amp;zx=867616dd-abac-4be0-893b-04a2fd85fc37' rel='stylesheet'/></noscript>
<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">

<script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>


</head>
<body>
<div class="header__overlay"></div>
<div class="section" id="nav"><div class="widget HTML" data-version="1" id="HTML1">
<header class="header">
<div aria-hidden="true" data-href="https://blog.tensorflow.org/" id="home-href" hidden="true"></div>
<div class="top-row">
<div class="top-row__left">
<button aria-label="Toggle menu" class="header__hamburger" type="button">
<i class="material-icons">menu</i>
</button>
<a class="tensorsite-blog-logo" href="https://blog.tensorflow.org/">
<img alt="TensorFlow Blog Logo" class="tensorsite-blog-logo__image" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/tfblog_lockup_neil.svg">
</a>
</div>
<div class="top-row__right">
<div class="header__search-container">
<form action="" class="searchbox">
<input aria-label="Search box" class="search-input" name="q" onblur='if (this.value=="")                             {this.value="Search the Blog";}' onfocus='if                             (this.value=="Search the Blog") {this.value=""}' placeholder="Search the Blog" type="text">
<i class="material-icons">search</i>
<input style="visibility:hidden;position:absolute" type="submit">
</form>
</div>
<a class="header__cta" href="https://www.tensorflow.org/">
<svg class="cta-icon" height="12" viewBox="0 0 18 18" width="12" xmlns="http://www.w3.org/2000/svg">
<g fill="none" fill-rule="evenodd" transform="translate(-3 -3)">
<rect height="24" width="24"></rect>
<path d="M20.55,10.95 L13.05,3.45 C12.45,2.85 11.55,2.85 10.95,3.45 C10.35,4.05 10.35,4.95 10.95,5.55 L15.9,10.5 L4.5,10.5 C3.6,10.5 3,11.1 3,12 C3,12.9 3.6,13.5 4.5,13.5 L15.9,13.5 L10.95,18.45 C10.35,19.05 10.35,19.95 10.95,20.55 C10.95,20.55 10.95,20.55 10.95,20.55 C11.55,21.15 12.45,21.15 13.05,20.55 C13.05,20.55 13.05,20.55 13.05,20.55 L20.55,13.05 C21.15,12.45 21.15,11.55 20.55,10.95 C20.55,10.95 20.55,10.95 20.55,10.95 Z" fill="#000"></path>
</g>
</svg>

                                    Return to TensorFlow Home
                                </a>
</div>
</div>
<div class="nav-row">
<div class="nav-items">
<tab>
<a class="header__nav-item all" dir="ltr" href="https://blog.tensorflow.org/">
All
</a>
</tab>
<tab>
<a class="header__nav-item" dir="ltr" href="https://blog.tensorflow.org/search?label=TensorFlow+Core&amp;max-results=20">
TensorFlow Core
</a>
</tab>
<tab>
<a class="header__nav-item" dir="ltr" href="https://blog.tensorflow.org/search?label=TensorFlow.js&amp;max-results=20">
TensorFlow.js
</a>
</tab>
<tab>
<a class="header__nav-item" dir="ltr" href="https://blog.tensorflow.org/search?label=TensorFlow+Lite&amp;max-results=20">
TensorFlow Lite
</a>
</tab>
<tab>
<a class="header__nav-item" dir="ltr" href="https://blog.tensorflow.org/search?label=TFX&amp;max-results=20">
TFX
</a>
</tab>
<tab>
<a class="header__nav-item" dir="ltr" href="https://blog.tensorflow.org/search?label=Community&amp;max-results=20">
Community
</a>
</tab>
</div>
<section class="social-icons">
<div class="social-icons__container-header">
<div class="social-icons__links">
<a class="icon-link" href="https://discuss.tensorflow.org/" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow Forum" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_forum_2.svg">
</a>
<a class="icon-link" href="https://www.youtube.com/tensorflow" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow YouTube" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_youtube.svg">
</a>
<a class="icon-link" href="https://twitter.com/TensorFlow" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow Twitter" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_twitter.svg">
</a>
<a class="icon-link" href="https://github.com/tensorflow" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow GitHub" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_github.svg">
</a>
</div>
</div>
</section>
</div>
</header>
<div class="header__side-menu">
<div class="header__side-menu__logo-container">
<a class="tensorsite-blog-logo" href="https://blog.tensorflow.org/">
<img alt="TensorFlow Blog Logo" class="tensorsite-blog-logo__image" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/tfblog_lockup_neil.svg">
</a>
</div>
<div class="header__side-menu__content">
<div class="header__side-menu__items">
<div class="header__search-container mobile">
<form action="" class="searchbox">
<input aria-label="Search box" class="search-input" name="q" onblur='if (this.value=="")                             {this.value="Search the Blog";}' onfocus='if                             (this.value=="Search the Blog") {this.value=""}' placeholder="Search the Blog" type="text">
<i class="material-icons">search</i>
<input style="visibility:hidden;position:absolute" type="submit">
</form>
</div>
<div class="header__side-menu__title">Tags</div>
<tab>
<li>
<a class="header__nav-item mobile" dir="ltr" href="https://blog.tensorflow.org/">
All
</a>
</li>
</tab>
<tab>
<li>
<a class="header__nav-item mobile" dir="ltr" href="https://blog.tensorflow.org/search?label=TensorFlow+Core&amp;max-results=20">
TensorFlow Core
</a>
</li>
</tab>
<tab>
<li>
<a class="header__nav-item mobile" dir="ltr" href="https://blog.tensorflow.org/search?label=TensorFlow.js&amp;max-results=20">
TensorFlow.js
</a>
</li>
</tab>
<tab>
<li>
<a class="header__nav-item mobile" dir="ltr" href="https://blog.tensorflow.org/search?label=TensorFlow+Lite&amp;max-results=20">
TensorFlow Lite
</a>
</li>
</tab>
<tab>
<li>
<a class="header__nav-item mobile" dir="ltr" href="https://blog.tensorflow.org/search?label=TFX&amp;max-results=20">
TFX
</a>
</li>
</tab>
<tab>
<li>
<a class="header__nav-item mobile" dir="ltr" href="https://blog.tensorflow.org/search?label=Community&amp;max-results=20">
Community
</a>
</li>
</tab>
</div>
<div class="spacer"></div>
<div class="header__side-menu__bottom">
<a class="header__cta mobile" href="https://www.tensorflow.org/">
                                Return to TensorFlow Home
                            </a>
</div>
</div>
</div>
</div></div>
<div class="content-wrap">
<div class="section" id="blog"><div class="widget FeaturedPost" data-version="1" id="FeaturedPost1">
</div><div class="widget Blog" data-version="1" id="Blog1">
<div class="tensorsite-container--narrow">
<div class="tensorsite-detail">
<a aria-hidden="true" class="tensorsite-detail__next-url" href="https://blog.tensorflow.org/2020/02/request-for-proposals-faculty-awards-to-support-machine-learning-courses-universities.html" hidden="true"></a>
<div aria-hidden="true" class="tensorsite-detail__current-url" hidden="true">https://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html</div>
<div aria-hidden="true" class="tensorsite-detail__tags" hidden="true">
<span>TensorFlow Core</span>
</div>
<div aria-hidden="true" class="tensorsite-detail__main-image" hidden="true">
https://1.bp.blogspot.com/-JIhDwG5oWI8/XkGvU5u4V8I/AAAAAAAACrI/xjrCMW3-F8UNfERlQITg9XmkBahPsbhPACLcBGAsYHQ/s1600/model_comparison_v4.png
</div>
<p aria-hidden="true" class="tensorsite-detail__description" hidden="true">
<span class="tensorsite-content__info">
February 10, 2020 —
                                          </span>
<em>Posted by <a href="https://www.linkedin.com/in/mahdi-milani-fard-6924731a1">Mahdi Milani Fard</a>, Software Engineer, Google Research</em><br><br>
Most ML practitioners have encountered the typical scenario where the 
training data looks very different from the run-time queries on which 
the model is evaluated. As a result, flexible ML solutions such as DNNs 
or forests that rely solely on the training dataset often act 
unexpectedly and even wildly in parts of the input space not …
</p>
<div class="tensorsite-content__subtitle">
<a href="https://blog.tensorflow.org/search?label=TensorFlow+Core&amp;max-results=20">
<span>TensorFlow Core</span>
</a>
</div>
<div class="tensorsite-detail__title">
 TensorFlow Lattice: Flexible, controlled and interpretable ML
</div>
<div class="tensorsite-detail__contact">
<div class="tensorsite-detail__info">
<span class="tensorsite-detail__timestamp">February 10, 2020</span>
</div>
<a class="icon-link" href="https://twitter.com/intent/tweet?text=%22%20TensorFlow%20Lattice:%20Flexible,%20controlled%20and%20interpretable%20ML%22%20from%20the%20TensorFlow%20Blog%0A%0Ahttps://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html" rel="noopener noreferrer" target="_blank" title="Share this post on Twitter">
<svg alt="Twitter Social Icon" class="twitter-icon social-icon" height="19" viewBox="0 0 23 19" width="23" xmlns="http://www.w3.org/2000/svg">
<g fill="none" fill-rule="evenodd" transform="translate(-7 -9)">
<rect height="36" width="36"></rect>
<path d="M14.076,27.2827953 C22.566,27.2827953 27.21,20.2477953 27.21,14.1477953 C27.21,13.9477953 27.21,13.7487953 27.197,13.5507953 C28.1,12.8977953 28.88,12.0887953 29.5,11.1617953 C28.657,11.5347953 27.764,11.7797953 26.848,11.8877953 C27.812,11.3107953 28.533,10.4037953 28.878,9.33479527 C27.972,9.87179527 26.98,10.2507953 25.947,10.4547953 C24.198,8.59579527 21.274,8.50679527 19.415,10.2547953 C18.217,11.3817953 17.708,13.0617953 18.08,14.6647953 C14.368,14.4787953 10.91,12.7257953 8.566,9.84279527 C7.341,11.9507953 7.967,14.6497953 9.995,16.0047953 C9.261,15.9827953 8.542,15.7837953 7.9,15.4267953 L7.9,15.4847953 C7.9,17.6827953 9.449,19.5747953 11.603,20.0107953 C10.924,20.1957953 10.211,20.2227953 9.519,20.0897953 C10.124,21.9707953 11.856,23.2587953 13.832,23.2957953 C12.197,24.5797953 10.178,25.2777953 8.098,25.2747953 C7.731,25.2747953 7.364,25.2527953 7,25.2087953 C9.111,26.5627953 11.567,27.2817953 14.076,27.2787953" fill="#545454"></path>
</g>
</svg>
</a>
</div>
<div class="divider divider--article-top"></div>
<div class="tensorsite-detail__body">
<em>Posted by <a href="https://www.linkedin.com/in/mahdi-milani-fard-6924731a1">Mahdi Milani Fard</a>, Software Engineer, Google Research</em><br>
<br>
Most ML practitioners have encountered the typical scenario where the 
training data looks very different from the run-time queries on which 
the model is evaluated. As a result, flexible ML solutions such as DNNs 
or forests that rely solely on the training dataset often act 
unexpectedly and even wildly in parts of the input space not covered by 
the training and validation datasets. This behaviour is especially 
problematic in cases where important policy or fairness constraints can 
be violated.<a name="more"></a><br>
<table class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;" cellspacing="0" cellpadding="0" align="center"><tbody>
<tr><td style="text-align: center;"><img data-original-height="470" data-original-width="850" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/model_comparison_v4.png" data-action="zoom" border="0"></td></tr><tr><td class="tr-caption" style="text-align: center;">Unconstrained
 models can behave unexpectedly where there is little training data 
coverage. Here, DNN and GBT predictions are far from the ground truth on
 the testing data.</td></tr></tbody></table>Even though common forms of 
regularization can result in more sensible extrapolation, standard 
regularizers cannot guarantee reasonable model behaviour across the 
entire input space, especially with high-dimensional inputs. Switching 
to simpler models with more controlled and predictable behaviour can 
come at a severe cost to the model accuracy.<br>
<br>
TF Lattice makes it possible to keep using flexible models, but provides
 several options to inject domain knowledge into the learning process 
through semantically meaningful common-sense or policy-driven shape 
constraints. For example, you can specify that the model output should 
be monotonically increasing with respect to a given input. These extra 
pieces of domain knowledge can help the model learn beyond just the 
training dataset and makes it behave in a manner controlled and expected
 by the user.<br>
<h3>TensorFlow Lattice Library</h3>TensorFlow Lattice is a library for training constrained and interpretable lattice based models. A lattice is an <i>interpolated look-up</i> table that can approximate arbitrary input-output relationships in your data.<br>
<center><img data-original-height="269" data-original-width="512" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/laticefunction.png" style="width:80%" data-action="zoom" border="0"></center>The
 simple example above is a lattice function over 2 input features and 
with 4 parameters, which are the function's values at the corners of the
 input space; the rest of the function is interpolated from these 
parameters. You can use higher dimensional lattices and a finer grained 
grid of parameters to get a more flexible function. The library 
implements the lattice with the <a href="https://tensorflow.org/lattice/api_docs/python/tfl/layers/Lattice">tfl.layers.Lattice</a> Keras layer.<br>
<br>
TensorFlow Lattice also provides piecewise linear functions (with <a href="https://tensorflow.org/lattice/api_docs/python/tfl/layers/PWLCalibration">tfl.layers.PWLCalibration</a>
 Keras layer) to calibrate and normalize the input features to the range
 accepted by the lattice: 0 to 1 in the example lattice above.<br>
<center><img alt="calibration distance and price graphs" data-original-height="290" data-original-width="679" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ScreenShot2020-02-07at12.png" style="width:90%" data-action="zoom" border="0"></center>For categorical features, TensorFlow Lattice provides categorical calibration (with <a href="https://tensorflow.org/lattice/api_docs/python/tfl/layers/CategoricalCalibration">tfl.layers.CategoricalCalibration</a>
 Keras layer) with similar output bounding to feed into a lattice. 
Combining the calibrators and the lattice above, we can get a <em>calibrated lattice</em> model.<br>
<br>
There are several forms of constraints you can impose on TensorFlow 
Lattice layers to inject your knowledge of the problem domain into the 
training process:<br>
<ul><li><strong>Monotonicity:</strong> You can specify that the output 
should only increase/decrease with respect to an input. In our example, 
you may want to specify that increased distance to a coffee shop should 
only decrease the predicted user preference.<br>
</li>
</ul><center><img alt="4 user preference by distance line graphs" data-original-height="554" data-original-width="690" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ScreenShot2020-02-07at12_002.png" style="width:90%" data-action="zoom" border="0"></center><ul><li><strong>Convexity/Concavity:</strong>
 You can specify that the function shape can be convex or concave. Mixed
 with monotonicity, this can force the function to represent diminishing
 returns with respect to a given feature.<br>
</li><li><strong>Unimodality:</strong> You can specify that the function
 should have a unique peak or unique valley. This lets you represent 
functions that are expected to have a sweet spot with respect to a 
feature.<br>
</li><li><strong>Pairwise trust:</strong> This constraint suggests that 
one input feature semantically reflects trust in another feature. For 
example, a higher number of reviews makes you more confident in the 
average star rating of a restaurant. The model will be more sensitive 
with respect to the star rating (i.e. will have a larger slope with 
respect to the rating) when the number of reviews is higher.<br>
</li><li><strong>Pairwise dominance:</strong> This constraint suggests 
that the model should treat one feature as more important than another 
feature. This is done by making sure the slope of the function is larger
 with respect to the dominant feature.</li></ul>In addition to shape 
constraints, TensorFlow lattice provides a number of regularizers to 
control the flexibility and smoothness of the function on a per-feature 
basis. These include <em>Laplacian Regularizer</em> (for a flatter function), <em>Hessian Regularizer</em> (for a more linear calibration function), <em>Wrinkle Regularizer</em> (for a smoother calibration function) and <em>Torsion Regularizer</em> (for a more co-linear lattice function). 
<h3>Example: Ranking Restaurants</h3>This example is from our end-to-end <a href="https://www.tensorflow.org/lattice/tutorials/shape_constraints">shape constraint tutorial</a>
 that covers many of the above mentioned constraints with canned 
estimators. Imagine a scenario where we want to determine whether or not
 users will click on a restaurant search result. The task is to predict 
the clickthrough rate (CTR) given input features: <ul><li><em>average rating</em>: a numeric feature in the range 1 to 5<br>
</li><li><em>number of reviews</em>: a numeric feature in range 0 to 200<br>
</li><li><em>sollar rating</em>: a categorical feature with values “$” to “$$$$” represented as 0 to 3 and missing value represented as -1</li></ul>We have these as the domain knowledge to confine and control our model’s behavior: <ul><li>Output is monotonically increasing in average rating<br>
</li><li>Output is monotonically increasing in number of reviews, but with diminishing returns<br>
</li><li>The model should trust the average rating more when there are more reviews<br>
</li><li>Users typically prefer “$$” restaurants to “$” restaurants</li><br>
</ul>We can construct a calibrated lattice model using the Keras layers provided by the library:  
<pre class="  language-python" tabindex="0"><code class="””  language-python">model <span class="token operator">=</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
   tfl<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>ParallelCombination<span class="token punctuation">(</span><span class="token punctuation">[</span>
       <span class="token comment"># Feature: average rating</span>
       tfl<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>PWLCalibration<span class="token punctuation">(</span>
           <span class="token comment"># Input keypoints for the piecewise linear function</span>
           input_keypoints<span class="token operator">=</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">.</span><span class="token punctuation">,</span> num<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token comment"># Output is monotonically increasing in this feature</span>
           monotonicity<span class="token operator">=</span><span class="token string">'increasing'</span><span class="token punctuation">,</span>
           <span class="token comment"># This layer is feeding into a lattice with 2 vertices</span>
           output_min<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>
           output_max<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token comment"># Feature: number of reviews</span>
       tfl<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>PWLCalibration<span class="token punctuation">(</span>
           input_keypoints<span class="token operator">=</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">.</span><span class="token punctuation">,</span> num<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token comment"># Output is monotonically increasing in this feature</span>
           monotonicity<span class="token operator">=</span><span class="token string">'increasing'</span><span class="token punctuation">,</span>
           <span class="token comment"># There is diminishing returns on the number of reviews</span>
           convexity<span class="token operator">=</span><span class="token string">'concave'</span><span class="token punctuation">,</span>
           <span class="token comment"># Regularizers defined as a tuple ('name', l1, l2)</span>
           kernel_regularizer<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'wrinkle'</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token comment"># This layer is feeding into a lattice with 3 vertices</span>
           output_min<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>
           output_max<span class="token operator">=</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token comment"># Feature: dollar rating</span>
       tfl<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>CategoricalCalibration<span class="token punctuation">(</span>
           <span class="token comment"># 4 rating categories + 1 missing category</span>
           num_buckets<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
           default_input_value<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
           <span class="token comment"># Partial monotonicity: calib(0) &lt;= calib(1)</span>
           monotonicities<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token comment"># This layer is feeding into a lattice with 2 vertices</span>
           output_min<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span>
           output_max<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
   tfl<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>Lattice<span class="token punctuation">(</span>
       <span class="token comment"># A 2x3x2 grid lattice</span>
       lattice_size<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token comment"># Output is monotonic in all inputs</span>
       monotonicities<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'increasing'</span><span class="token punctuation">,</span> <span class="token string">'increasing'</span><span class="token punctuation">,</span> <span class="token string">'increasing'</span><span class="token punctuation">]</span>
       <span class="token comment"># Trust: more responsive to input 0 if input 1 increases</span>
       edgeworth_trusts<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'positive'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></code></pre>The resulting trained model satisfies all the specified constraints, and the added regularization makes the function smooth: <center><img data-original-height="419" data-original-width="512" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/laticediagram.png" style="width:80%" data-action="zoom" border="0"></center>The above model can also be constructed using canned estimators provided by the library. Check out in our <a href="https://tensorflow.org/lattice/tutorials/shape_constraints">shape constraints tutorial</a>
 for more details in an end-to-end colab describing the effect of each 
of the described constraints.  TF Lattice Keras layers can also be used 
in combination with other Keras layers to construct partially 
constrained or regularized models. For example, lattice or PWL 
calibration layers can be used at the last layer of deeper networks that
 include embeddings or other Keras layers.  For further information 
check out the <a href="https://tensorflow.org/lattice">Tensorflow Lattice website</a>. There are many guides and tutorials available to get you started: <a href="https://tensorflow.org/lattice/tutorials/shape_constraints">shape constraints</a>, <a href="https://tensorflow.org/lattice/tutorials/canned_estimators">canned estimators</a>, <a href="https://tensorflow.org/lattice/tutorials/custom_estimators">custom estimators</a>, and <a href="https://tensorflow.org/lattice/tutorials/keras_layers">Keras layers</a>. Also check out our presentation at the TF Dev Summit:  
<br><br>
<iframe src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ABBnNjbjv2Q.html" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" width="560" height="315" frameborder="0"></iframe>  
<h3>Feedback</h3>We are looking forward to hearing your thoughts and comments on the library. For bugs or issues, please reach out to us on <a href="https://github.com/tensorflow/lattice">Github</a>.  
<h3>Acknowledgements</h3>This release was made possible with 
contributions from Oleksandr Mangylov‎, Mahdi Milani Fard, Taman 
Narayan‎, Yichen Zhou‎, Nobu Morioka‎, William Bakst‎, Harikrishna 
Narasimhan‎, Andrew Cotter‎ and Maya Gupta. 
<h3>Publications</h3>For further details on the models and algorithms used within the library, check out our publications on lattice models: <ul><li><a href="https://arxiv.org/abs/2001.11990">Deontological Ethics By Monotonicity Shape Constraints</a>, Serena Wang, Maya Gupta, International Conference on Artificial Intelligence  and Statistics (AISTATS), 2020<br>
</li><li><a href="http://proceedings.mlr.press/v97/cotter19a.html">Shape Constraints for Set Functions</a>,
 Andrew Cotter, Maya Gupta, H. Jiang, Erez Louidor, Jim Muller, Taman 
Narayan, Serena Wang, Tao Zhu. International Conference on Machine 
Learning (ICML), 2019<br>
</li><li><a href="https://papers.nips.cc/paper/7916-diminishing-returns-shape-constraints-for-interpretability-and-regularization">Diminishing Returns Shape Constraints for Interpretability and Regularization</a>, Maya Gupta, Dara Bahri, Andrew Cotter, Kevin Canini, Advances in Neural Information Processing Systems (NeurIPS), 2018<br>
</li><li><a href="https://research.google.com/pubs/pub46327.html">Deep Lattice Networks and Partial Monotonic Functions</a>,
 Seungil You, Kevin Canini, David Ding, Jan Pfeifer, Maya R. Gupta, 
Advances in Neural Information Processing Systems (NeurIPS), 2017<br>
</li><li><a href="https://papers.nips.cc/paper/6377-fast-and-flexible-monotonic-functions-with-ensembles-of-lattices">Fast and Flexible Monotonic Functions with Ensembles of Lattices</a>,
 Mahdi Milani Fard, Kevin Canini, Andrew Cotter, Jan Pfeifer, Maya 
Gupta, Advances in Neural Information Processing Systems (NeurIPS), 2016<br>
</li><li><a href="http://jmlr.org/papers/v17/15-243.html">Monotonic Calibrated Interpolated Look-Up Tables</a>,
 Maya Gupta, Andrew Cotter, Jan Pfeifer, Konstantin Voevodski, Kevin 
Canini, Alexander Mangylov, Wojciech Moczydlowski, Alexander van 
Esbroeck, Journal of Machine Learning Research (JMLR), 2016<br>
</li><li><a href="http://ieeexplore.ieee.org/document/6203580/">Optimized Regression for Efficient Function Evaluation</a>, Eric Garcia, Raman Arora, Maya R. Gupta, IEEE Transactions on Image Processing, 2012<br>
</li><li><a href="https://papers.nips.cc/paper/3694-lattice-regression">Lattice Regression</a>, Eric Garcia, Maya Gupta, Advances in Neural Information Processing Systems (NeurIPS), 2009<br>
</li><br>
</ul>
</div>
</div>
<div class="tensorsite-detail-footer">
<div class="article-divider">
<img alt="Diamond Article Divider" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_article_end.svg">
</div>
<a class="tensorsite-chip" href="https://blog.tensorflow.org/search?label=TensorFlow+Core&amp;max-results=20">
TensorFlow Core
</a>
</div>
</div>
<div class="tensorsite-next active">
<div class="tensorsite-container--large">
<div class="tensorsite-next__title">Next post</div>
<div class="tensorsite-card">
<a aria-label="Next Card" class="tensorsite-card__href next" href="https://blog.tensorflow.org/2020/02/request-for-proposals-faculty-awards-to-support-machine-learning-courses-universities.html"></a>
<div class="tensorsite-content__image-wrapper">
<img alt=" TensorFlow Lattice: Flexible, controlled and interpretable ML" class="tensorsite-content__image" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/tflogo.png">
</div>
<div class="tensorsite-content">
<div class="tensorsite-content__subtitle next">
</div>
<div class="tensorsite-content__title next">
Request for Proposals: Faculty Awards to Support Machine Learning Courses, Diversity, and Inclusion
</div>
<p class="tensorsite-content__description next">February 07, 2020 — Posted by Josh Gordon for the TensorFlow team<br>Update.
 Applications have closed for this year due to overwhelming interest and
 a large number of high-quality applications. Thank you, everyone!&nbsp;<br>Google
 AI and the TensorFlow team have a new funding opportunity open to 
universities. If you’re a faculty member interested in teaching machine 
learning courses, and/or leading or contributing to diversity …</p>
</div>
</div>
</div>
</div>
<!--Can't find substitution for tag [posts.post]-->
</div></div>
</div>
<!-- End Page Container -->
<div class="tensorsite-full-footer">
<div class="section" id="footer"><div class="widget HTML" data-version="1" id="HTML2">
<section class="tensorsite-footer grey">
<div class="tensorsite-container tensorsite-footer__container">
<div class="tensorsite-footer__side tensorsite-footer__side--left"></div>
<div class="tensorsite-footer__side tensorsite-footer__side--right"></div>
<div class="tensorsite-footer__content">
<div class="tensorsite-content">
<div class="tensorsite-content__title  tensorsite-content__title--grow">
                                        Build, deploy, and experiment easily with TensorFlow </div>
<div class="tensorsite-content__cta-wrapper">
<a class="tensorsite-content__button tensorsite-button tensorsite-button--white" href="https://www.tensorflow.org/">
                                        Get started
                                    </a>
</div>
</div>
</div>
</div>
<div class="tensorsite-footer__lines"></div>
</section>
<section class="social-icons">
<div class="social-icons__container-footer">
<a class="tensorsite-logo" href="https://www.tensorflow.org/">
<img alt="TensorFlow Logo" class="tensorsite-logo__image" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/tf_lockup.svg">
</a>
<div class="social-icons__links">
<a class="icon-link" href="https://www.youtube.com/tensorflow" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow YouTube" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_youtube.svg">
</a>
<a class="icon-link" href="https://twitter.com/TensorFlow" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow Twitter" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_twitter.svg">
</a>
<a class="icon-link" href="https://github.com/tensorflow" rel="noopener noreferrer" target="_blank">
<img alt="TensorFlow GitHub" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/ic_github.svg">
</a>
</div>
</div>
</section>
</div></div>
</div>
<!--Va\u0161a je odgovornost obavijestiti posjetitelje o kola\u010di\u0107ima koje upotrebljavate na svom blogu i podacima koje tamo prikupljate. Blogger nudi standardnu obavijest koju mo\u017eete upotrijebiti na blogu, no mo\u017eete je i prilagoditi ili zamijeniti vlastitom. Ako vas zanimaju dodatne pojedinosti, pro\u010ditajte http://www.blogger.com/go/cookiechoices.-->
<script defer="defer" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/cookienotice.html"></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'Ova web-lokacija upotrebljava Googleove kola\u010di\u0107e radi pru\u017eanja svojih usluga i analize prometa. Va\u0161a IP adresa i korisni\u010dki agent te mjerni podaci o uspje\u0161nosti i sigurnosti dijele se s Googleom radi odr\u017eavanja kvalitete usluge, generiranja statistike upotrebe te otkrivanja i rje\u0161avanja zloupotrebe.',
          (window.cookieOptions && cookieOptions.close) || 'U redu',
          (window.cookieOptions && cookieOptions.learn) || 'Saznajte vi\u0161e',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="TensorFlow%20Lattice%20Flexible,%20controlled%20and%20interpretable%20ML%20%E2%80%94%20The%20TensorFlow%20Blog_files/745028019-widgets.js"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY5k7wcG-EgBdaFeTAn5psu4Hj0xMw:1631608843191';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d7864883956188652345','//blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html','7864883956188652345');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '7864883956188652345', 'title': 'The TensorFlow Blog', 'url': 'https://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html', 'canonicalUrl': 'https://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html', 'homepageUrl': 'https://blog.tensorflow.org/', 'searchUrl': 'https://blog.tensorflow.org/search', 'canonicalHomepageUrl': 'https://blog.tensorflow.org/', 'blogspotFaviconUrl': 'https://blog.tensorflow.org/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The TensorFlow Blog - Atom\x22 href\x3d\x22https://blog.tensorflow.org/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22The TensorFlow Blog - RSS\x22 href\x3d\x22https://blog.tensorflow.org/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The TensorFlow Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/7864883956188652345/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The TensorFlow Blog - Atom\x22 href\x3d\x22https://blog.tensorflow.org/feeds/8792713771000730408/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/403901366-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/7af3909b5eef9d0d', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '8792713771000730408', 'postImageThumbnailUrl': 'https://1.bp.blogspot.com/-JIhDwG5oWI8/XkGvU5u4V8I/AAAAAAAACrI/xjrCMW3-F8UNfERlQITg9XmkBahPsbhPACLcBGAsYHQ/s72-c/model_comparison_v4.png', 'postImageUrl': 'https://1.bp.blogspot.com/-JIhDwG5oWI8/XkGvU5u4V8I/AAAAAAAACrI/xjrCMW3-F8UNfERlQITg9XmkBahPsbhPACLcBGAsYHQ/s1600/model_comparison_v4.png', 'pageName': ' TensorFlow Lattice: Flexible, controlled and interpretable ML', 'pageTitle': 'The TensorFlow Blog:  TensorFlow Lattice: Flexible, controlled and interpretable ML', 'metaDescription': ''}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': ' TensorFlow Lattice: Flexible, controlled and interpretable ML', 'description': 'The TensorFlow blog contains regular news from the TensorFlow team and the community, with articles on Python, TensorFlow.js, TF Lite, TFX, and more.', 'featuredImage': 'https://1.bp.blogspot.com/-JIhDwG5oWI8/XkGvU5u4V8I/AAAAAAAACrI/xjrCMW3-F8UNfERlQITg9XmkBahPsbhPACLcBGAsYHQ/s1600/model_comparison_v4.png', 'url': 'https://blog.tensorflow.org/2020/02/tensorflow-lattice-flexible-controlled-and-interpretable-ML.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 8792713771000730408}}]);
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'nav', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_FeaturedPostView', new _WidgetInfo('FeaturedPost1', 'blog', document.getElementById('FeaturedPost1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'blog', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/1671149202-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4076883957-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML2', 'footer', document.getElementById('HTML2'), {}, 'displayModeFull'));
</script>

</body></html>