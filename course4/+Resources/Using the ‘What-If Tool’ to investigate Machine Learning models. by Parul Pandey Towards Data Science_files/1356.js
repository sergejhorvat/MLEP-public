(self.webpackChunklite=self.webpackChunklite||[]).push([[1356],{965:(e,t,n)=>{"use strict";n.d(t,{JP:()=>b,CP:()=>P});var o=n(59713),r=n.n(o),i=n(63038),l=n.n(i),a=n(28655),s=n.n(a),u=n(71439),c=n(46829),p=n(67294),d=n(58006),v=n(94945);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(){var e=s()(["\n  mutation ClapMutation($targetPostId: ID!, $userId: ID!, $numClaps: Int!) {\n    clap(targetPostId: $targetPostId, userId: $userId, numClaps: $numClaps) {\n      viewerEdge {\n        ...ClapMutation_viewerEdge\n      }\n      ...ClapMutation_post\n    }\n  }\n  ","\n  ","\n"]);return C=function(){return e},e}function g(){var e=s()(["\n  fragment ClapMutation_viewerEdge on PostViewerEdge {\n    __typename\n    id\n    clapCount\n  }\n"]);return g=function(){return e},e}function h(){var e=s()(["\n  fragment ClapMutation_post on Post {\n    __typename\n    id\n    clapCount\n    ...MultiVoteCount_post\n  }\n  ","\n"]);return h=function(){return e},e}var b=(0,u.Ps)(h(),d.U),w=(0,u.Ps)(g()),E=(0,u.Ps)(C(),b,w),P=function(){var e=(0,c.useMutation)(E),t=l()(e,1)[0];return(0,p.useCallback)((function(e,n,o,r){return t({variables:{targetPostId:e.id,userId:n,numClaps:o},optimisticResponse:{clap:m(m({__typename:"Post"},e),{},{clapCount:e.clapCount+o,viewerEdge:{__typename:"PostViewerEdge",id:(0,v.Q)(e.id,n),clapCount:o}})},update:function(t,n){var i,l=null==n||null===(i=n.data)||void 0===i?void 0:i.clap;if(l){var a=t.readFragment({id:"Post:".concat(l.id),fragment:b,fragmentName:"ClapMutation_post"});t.writeFragment({id:"Post:".concat(l.id),fragment:b,fragmentName:"ClapMutation_post",data:m(m({},a),{},{clapCount:e.clapCount+o,viewerClapCount:((null==r?void 0:r.clapCount)||0)+o})})}}})}),[])}},21356:(e,t,n)=>{"use strict";n.d(t,{x:()=>x,S:()=>M});var o=n(28655),r=n.n(o),i=n(71439),l=n(67294),a=n(12291),s=n(42631),u=n(9077),c=n(17920),p=n(60002),d=n(41236),v=n(86654),f=n(88817),m=n(70162),C=n(3369),g=n(965),h=n(58006),b=n(76532),w=n(1932),E=n(324),P=n(62181),S=n(95760),y=n(51512),I=n(65347),_=n(67297),V=n(55573),O=n(27952);function k(){var e=r()(["\n  fragment MultiVote_post on Post {\n    id\n    clapCount\n    creator {\n      id\n      ...SusiClickable_user\n    }\n    isPublished\n    ...SusiClickable_post\n    collection {\n      id\n      slug\n    }\n    isLimitedState\n    ...MultiVoteCount_post\n  }\n  ","\n  ","\n  ","\n"]);return k=function(){return e},e}var F=function(e){var t,n=e.post,o=e.buttonStyle,r=e.hasDialog,i=e.shouldShowResponsiveLabelText,k=void 0!==i&&i,F=e.shouldHideClapsText,x=void 0!==F&&F,M=e.shouldHideClapsCount,D=void 0!==M&&M,L=e.susiEntry,T=e.verticalClapsText,H=void 0!==T&&T,$=(0,g.CP)(),j=(0,b.H)().value,U=null!==(t=null==j?void 0:j.id)&&void 0!==t?t:"",R=(0,w.T)(n).viewerEdge,N=(0,_.v9)((function(e){return e.config.authDomain})),A=(0,_.b$)((function(e){return e.multiVote.clapsPerPost})),B=(0,a.I0)(),q=function(e){return B((0,I.at)(e))},Q=(0,S.Av)(),J=(0,y.pK)(),z=(0,V.l)(A,n,R),W=z.clapCount,Y=z.viewerClapCount,K=z.viewerHasClappedSinceFetch,G=l.useCallback((function(){if(Y&&Y>=m.S2)return"Viewer exceeded authorized claps limit.";q({postId:n.id,clapCount:W+1,viewerClapCount:Y+1,viewerHasClappedSinceFetch:!0})}),[Y,n.id,W]),X=l.useCallback((function(){if(!Y)return"Viewer did not clap.";$(n,U,-Y,R),q({postId:n.id,clapCount:W-Y,viewerClapCount:0,viewerHasClappedSinceFetch:!0}),Q.event("post.clientUnvote",{postId:n.id,postIds:[n.id],unvoteCount:Y,source:J})}),[Y,n.id,W,U,R,J]),Z=l.useCallback((function(e){$(n,U,e,R),Q.event("post.clientUpvote",{postId:n.id,postIds:[n.id],voteCount:e,source:J})}),[n.id,U,R,J]),ee=(0,C.m)({onIncrementClaps:G,onUndoClaps:X,onSubmitClapsAccumulated:Z}),te=ee.clappedAt,ne=ee.onFloatEnd,oe=ee.removeBurst,re=ee.clap,ie=ee.undoClaps,le=ee.isPopping,ae=ee.isShowingViewerClapCount,se=ee.burstOffsets,ue=ee.onPopEnd;l.useEffect((function(){return function(){var e;e={postId:n.id},B((0,I.HQ)(e))}}),[]);var ce,pe=n.collection,de=n.creator,ve=n.id,fe=n.isPublished,me=n.isLimitedState,Ce=(ce=!(!de||de.id!==U),me?"This feature is temporarily disabled":fe?ce?"You cannot applaud your own story":void 0:"You cannot applaud a draft"),ge=(0,m.wH)(o,k),he=ge.isObvious,be=ge.isSubtleForDesktop,we=ge.alwaysShowClapsLabel,Ee=ge.hasClapsLabel,Pe=ge.buttonScale,Se=!!(Y&&Y>0),ye=!!(W&&W>0),Ie=pe&&pe.slug?(0,O.JLP)(N,pe.slug,ve):(0,O.kIi)(N,ve);return l.createElement(c.l,{isSubtleForDesktop:be,verticalClapsText:H},l.createElement(d.$,{isObvious:he,buttonStyle:o,isSubtleForDesktop:be,disableReason:Ce},U||Ce?l.createElement(l.Fragment,null,ae&&l.createElement(E.N8,null,l.createElement(p.q,{count:Y,clappedAt:te,placement:he?"FAR":"NEAR",onFloatEnd:ne})),l.createElement(f.v,{isPopping:le,onPopEnd:ue},l.createElement(u.d,{scale:Pe,canUndo:Se,isCircle:he,isFilled:Se,isUndoSuppressed:se.length>0,disableReason:Ce,onClickAndHold:re,onUndo:ie,shouldHideClapsText:x})),se.map((function(e){return l.createElement(s.P,{key:e,isLarge:he,offset:e,onBurstEnd:oe})}))):l.createElement(P.R9,{operation:"register",post:n,user:n.creator,actionUrl:Ie,susiEntry:L},l.createElement(u.d,{isCircle:he,scale:Pe}))),ye&&!D&&(!ae||we)&&l.createElement(v.W,{buttonStyle:o,isSubtleForDesktop:be},l.createElement(h._,{shouldShowNetwork:he,post:n,clapCount:W,showFullNumber:K,hasLabel:Ee,hasDialog:r,shouldShowResponsiveLabelText:be||k,shouldHideClapsText:x})))},x=(0,i.Ps)(k(),P.qU,P.Vm,h.U),M=function(e){var t;return l.createElement(y.cW,{source:{postId:null===(t=e.post)||void 0===t?void 0:t.id},extendSource:!0},l.createElement(F,e))}},58006:(e,t,n)=>{"use strict";n.d(t,{_:()=>L,U:()=>T});var o=n(28655),r=n.n(o),i=n(71439),l=n(67294),a=n(42711),s=n(319),u=n.n(s),c=n(82492),p=n.n(c),d=n(80439),v=n(12237),f=n(23025),m=n(31001),C=n(85677);function g(){var e=r()(["\n  query PostVotersDialogQuery($postId: ID!, $pagingOptions: PagingOptions) {\n    post(id: $postId) {\n      id\n      title\n      clapCount\n      voterCount\n      voters(paging: $pagingOptions) {\n        items {\n          user {\n            id\n            ...UserFollowButton_user\n            ...Voter_user\n          }\n          clapCount\n        }\n        pagingInfo {\n          next {\n            page\n          }\n        }\n      }\n      ...UserFollowButton_post\n    }\n  }\n  ","\n  ","\n  ","\n"]);return g=function(){return e},e}var h=function(e){var t=e.post,n=e.hide,o=e.isVisible,r=e.fetchMore;if(!t)return null;var i=t.title,a=t.voters,s=t.clapCount,u=t.voterCount;return l.createElement(v.x,{isVisible:o,fetchMore:r,hide:n,title:i,clapCount:s,voterCount:u,voters:a?a.items.map((function(e){var n=e.user,o=e.clapCount;return n&&l.createElement(f.a,{user:n,clapCount:o,key:n.id,followButton:l.createElement(m.Bv,{buttonSize:"SMALL",post:t,user:n,susiEntry:"follow_list"})})})):null})};function b(e){var t=e.postId,n=e.isVisible,o=e.hide;return n?l.createElement(d.AE,{ssr:!1,query:w,variables:{postId:t,pagingOptions:{limit:10}}},(function(e){var t,r=e.data,i=(r=void 0===r?{}:r).post,a=e.loading,s=e.error,c=e.fetchMore;if(a)return l.createElement(C.T,null);if(s||null==i||!i.voters)return null;var d=i.voters.pagingInfo&&i.voters.pagingInfo.next;if(d){var v={page:d.page};t=function(){return c({variables:{pagingOptions:v},updateQuery:function(e,t){var n,o,r,i,l,a,s=t.fetchMoreResult;return p()({},s,{post:{voters:{items:[].concat(u()(null!==(n=null==e||null===(o=e.post)||void 0===o||null===(r=o.voters)||void 0===r?void 0:r.items)&&void 0!==n?n:[]),u()(null!==(i=null==s||null===(l=s.post)||void 0===l||null===(a=l.voters)||void 0===a?void 0:a.items)&&void 0!==i?i:[]))}}})}})}}return l.createElement(h,{hide:o,fetchMore:t,post:i,isVisible:n})})):null}var w=(0,i.Ps)(g(),f.J,m.sj,m.S$),E=n(23450),P=n.n(E),S=n(1932),y=n(42933),I=n(82318),_=n(98024),V=n(27390),O=n(11642);function k(){var e=r()(["\n  fragment PostVotersNetwork_post on Post {\n    id\n    voterCount\n    recommenders {\n      name\n    }\n  }\n"]);return k=function(){return e},e}var F=function(e){var t,n,o=e.post,r=e.showVoters,i=(0,S.T)(o).viewerEdge,a=null!==(t=null===(n=o.recommenders)||void 0===n?void 0:n.map((function(e){return e.name})).filter(O.b))&&void 0!==t?t:[],s=(null!=i&&i.clapCount?["you"]:[]).concat(a).slice(0,2);if(!s.length)return null;var u=(o.voterCount||0)-s.length,c=s.join(u>0?", ":" and "),p="".concat(s.length>1?",":""," and"),d=P()("other",u),v=u>0?"".concat(p," ").concat((0,V.rR)(u)," ").concat(d):"";return l.createElement(y.x,{sm:{display:"none"}},l.createElement(I.r,{onClick:r},l.createElement(_.F,{scale:"S"},"Applause from ".concat(c).concat(v))))},x=(0,i.Ps)(k()),M=n(19464);function D(){var e=r()(["\n  fragment MultiVoteCount_post on Post {\n    id\n    ...PostVotersNetwork_post\n  }\n  ","\n"]);return D=function(){return e},e}function L(e){var t=e.clapCount,n=e.hasLabel,o=void 0!==n&&n,r=e.showFullNumber,i=void 0!==r&&r,s=e.post,u=e.shouldShowNetwork,c=e.hasDialog,p=void 0!==c&&c,d=e.shouldShowResponsiveLabelText,v=void 0!==d&&d,f=e.shouldHideClapsText,m=void 0!==f&&f,C=s.id;if(!(t>0))return null;var g=function(e){var n=e.showVoters;return l.createElement(a.$,{showVoters:n,hasLabel:o,showFullNumber:i,shouldShowResponsiveLabelText:v,shouldHideClapsText:m,label:u&&n?l.createElement(F,{showVoters:n,post:s}):null,clapCount:t})};return p&&C?l.createElement(M.B,null,(function(e){var t=e.isVisible,n=e.show,o=e.hide;return l.createElement(l.Fragment,null,l.createElement(g,{showVoters:n}),l.createElement(b,{isVisible:t,hide:o,postId:C}))})):l.createElement(g,null)}var T=(0,i.Ps)(D(),x)},55573:(e,t,n)=>{"use strict";function o(e,t,n){return!!t&&e[t.id]||{clapCount:(null==t?void 0:t.clapCount)||0,viewerClapCount:(null==n?void 0:n.clapCount)||0,viewerHasClappedSinceFetch:!1}}n.d(t,{l:()=>o})}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/1356.126496d2.chunk.js.map